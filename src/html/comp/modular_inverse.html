<div class="card">
  <div class="card-body">
    <h4 class="card-title">モジュラ逆数</h4><hr />
    <h6>考え方</h6>
    <p>
      競技プログラミングでよく見る「 $10^9 + 7$ で割った余りを出力せよ」っていう問題で使うものです. 
      往々にして, 計算結果が爆発する組み合わせの問題なんかに出てきます. 
    </p>
    <p>
      出力を X で割った余りとするときには, 計算過程を全て $X$ を法とする群の中で行っても構わないことになります. 
      Xを法とする群は「整数をそれぞれ $X$ で割った余りに対応させた世界」みたいな感じで考えるとわかりやすいと思います. 
      例えば「$(a + b) × c$ の値を$5$で割った余りを出力せよ」なんていう問題のとき, $a = 3$, $b = 4$, $c = 8$であれば, 
    </p>
    <p>
      普通に計算すると,
      $$(3 + 4) × 8 = 7 × 8 = 56 \equiv 1 ({\rm mod} 5)$$
    </p>
    <p>
      計算過程も含めて5を法とする群の中で行うと,
      $$(3 + 4) × 3 = 2 × 3 = 6 \equiv 1 ({\rm mod} 5)$$
    </p>
    <p>
      と一致します. 
      こうすることで計算過程で64bit 整数の表現可能範囲を超えてしまったりする場合にも正しく計算することが出来ます. 
      ただ割り算については, 足し算や掛け算のように通常の計算と同様に行うことが出来ないので「掛け算に変換する」という処理をします.
    </p>
    <p>
      「$a$で割る」ということは「$a$の逆数を掛ける」ということに等しくなります. 
      通常で考えれば, $a$の逆数は「$\frac{1}{a}$」になりますが, $X$ を法とする群には, 「$\frac{1}{a}$」が存在するとは限りません. (というか a = 1 の時しか存在しません) 
      ところで「$a$の逆数」とは? というと, $a × a^{-1} = 1$ となるような $a^{-1}$ が $a$ の逆数になります. 
      これであれば, $X$ を法とする群にも存在します. 
    </p>
    <p>
      例えば上の計算を見てみると, $5$ を法とする群の中では,
      $$ (2 × 3 \equiv 1 ({\rm mod} 5) $$
      であるので $2$ の逆数は $3$ であり, $3$ の逆数は $2$ であるということが分かります. 
      つまり, 「$2$ で割る」ということは「$3$ を掛ける」ということに等しくなります. 
    </p>
    <p>
      この $X$ を法とする群に存在する $a$ の逆数, 「モジュラ逆数」が求められれば, 全ての計算が $X$ を法とする群の中で, 行えることになります.
      このモジュラ逆数の求め方をどうにかしよう〜というのがこのページです.
    </p><hr />
    <h6>フェルマーの小定理</h6>
    <p>
      $p$ を素数とし, $a$ を $p$ の倍数でない整数とするとき<br />
      $$a^{p-1} ≡ 1 (mod p)$$
    </p>
    <p>
      この定理を使うと, 法とする数が素数であれば, 簡単にそのモジュラ逆数を求めることが出来ます. 
      要は, モジュラ逆数は $a^{-1}$ なのでこれをフェルマーの小定理の両辺に掛けると<br />
      $$ a^{p-2} \equiv a^{-1} (mod p) $$
      これでモジュラ逆数が求まります. 
      とても簡単!
    </p><hr />
    <h6>拡張ユークリッド互除法</h6>
    
  </div>
</div>
